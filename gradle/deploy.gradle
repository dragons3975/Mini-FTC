ssh.settings {
    knownHosts = allowAnyHosts
}

task pkillJava {
    doLast {
        ssh.run {
            session(remotes.ev3dev) {
                execute "pkill java || exit 0"
            }
        }
    }
}

task deploy {
    doLast {
        ssh.run {
            session(remotes.ev3dev) {
                put from: "${projectDir}/build/libs/" + "${rootProject.name}" + "-" + version + "-all.jar", into: "/home/robot/"
                put from: "${projectDir}/scripts/01_Start.sh", into: "/home/robot/"
                execute "sed -i 's/\r//g' /home/robot/01_Start.sh"
                execute "chmod +x /home/robot/01_Start.sh"
            }
        }
    }
}
deploy.dependsOn clean, shadowJar

task remoteRun {
    doLast {
        ssh.run {
            session(remotes.ev3dev) {
                execute "/home/robot/01_Start.sh"
            }
        }
    }
}

task deployAndRun {
    doLast {
    }
}
deployAndRun.dependsOn deploy, remoteRun

//Organize tasks in a Group
def groupName = " mini-ftc"
pkillJava.group = groupName
deploy.group = groupName
remoteRun.group = groupName
deployAndRun.group = groupName
